# Environment Variables - Complete Setup Guide

## üöÄ Quick Setup for New Workspaces

### Automatic Setup (Recommended)
The `.gitpod/setup-env.sh` script runs automatically when you open a new workspace. It will:
1. Check if `.env.local` exists
2. Try to pull from Vercel if authenticated
3. Create a minimal `.env.local` with public variables

### Manual Setup

**Option 1: Pull from Vercel (Best)**
```bash
vercel login
vercel env pull .env.local
```

**Option 2: Copy from Template**
```bash
cp .env.local.template .env.local
# Then fill in values from Vercel dashboard
```

## üìã All Configured Variables

### Critical Variables (35 total)

#### Database & Authentication
- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- `SUPABASE_SERVICE_ROLE_KEY`
- `SUPABASE_DB_URL`
- `POSTGRES_USER`
- `POSTGRES_HOST`
- `POSTGRES_DATABASE`
- `POSTGRES_PASSWORD`
- `POSTGRES_PORT`

#### Payment Processing
- `NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY`
- `STRIPE_SECRET_KEY`

#### Site Configuration
- `NEXT_PUBLIC_ORGANIZATION_NAME`
- `NEXT_PUBLIC_SITE_URL`
- `NEXT_PUBLIC_APP_URL`
- `NODE_ENV`

#### Authentication & Security
- `NEXTAUTH_SECRET`
- `NEXTAUTH_URL`
- `SESSION_MAX_AGE_MINUTES`

#### OAuth Providers
- `LINKEDIN_CLIENT_ID`
- `LINKEDIN_CLIENT_SECRET`

#### Email Services
- `RESEND_API_KEY`
- `SMTP_FROM_EMAIL`
- `SMTP_FROM_NAME`
- `MOU_ARCHIVE_EMAIL`

#### Analytics
- `NEXT_PUBLIC_GA_MEASUREMENT_ID`

#### AI Features
- `OPENAI_API_KEY`

#### Federal APIs
- `SAM_GOV_API_KEY`
- `SAM_API_TOKEN`

#### Video
- `NEXT_PUBLIC_VIMEO_BASE_URL`

#### Development
- `DEBUG`
- `SKIP_EMAIL_SEND`

## üîí Where Variables Are Stored

### 1. Vercel (Production - Source of Truth)
All variables are configured in Vercel dashboard:
https://vercel.com/team_Ae8f33vVYR36quLOS8HCeROs/fix2-gpql/settings/environment-variables

### 2. Local Workspace (`.env.local`)
- Gitignored (never committed)
- Auto-generated by setup script
- Loaded automatically by Next.js

### 3. Dev Container (`.devcontainer/devcontainer.json`)
- Contains public variables only in `remoteEnv`
- Safe to commit (no secrets)

## üîÑ Syncing Variables

### From Vercel to Local
```bash
vercel env pull .env.local
```

### From Local to Vercel
```bash
# Add new variable
vercel env add VARIABLE_NAME

# Or use Vercel dashboard (recommended)
```

## ‚úÖ Verification

Test that variables are loaded:
```bash
node -e "require('dotenv').config({path:'.env.local'}); console.log('Supabase URL:', process.env.NEXT_PUBLIC_SUPABASE_URL ? 'SET' : 'NOT SET')"
```

Or run the database connection test:
```bash
npm run check:db
```

## üÜò Troubleshooting

### Variables not loading
1. Check `.env.local` exists: `ls -la .env.local`
2. Verify format: `cat .env.local | head -20`
3. Restart dev server: `npm run dev`

### Vercel CLI not working
```bash
# Install/update
npm install -g vercel

# Login
vercel login

# Link project
vercel link

# Pull variables
vercel env pull .env.local
```

### New workspace missing variables
1. Run: `bash .gitpod/setup-env.sh`
2. Or: `vercel login && vercel env pull .env.local`

## üìù Adding New Variables

1. Add to Vercel dashboard
2. Pull to local: `vercel env pull .env.local`
3. Restart dev server

## üîê Security Notes

- ‚ö†Ô∏è **Never commit `.env.local`** - It's gitignored
- ‚ö†Ô∏è **Never hardcode secrets in scripts** - Use Vercel CLI
- ‚úÖ **Public variables** (NEXT_PUBLIC_*) are safe in devcontainer
- ‚úÖ **Private variables** must be pulled from Vercel

## üìö Related Files

- `.env.local` - Your local environment variables (gitignored)
- `.env.local.template` - Template with placeholders
- `.env.example` - Full example with all possible variables
- `.gitpod/setup-env.sh` - Auto-setup script
- `.devcontainer/devcontainer.json` - Dev container config with public vars

## ‚ú® Summary

**For existing workspace:** Variables are already in `.env.local` ‚úÖ

**For new workspace:** Run `vercel login && vercel env pull .env.local`

**For production:** Variables are in Vercel dashboard ‚úÖ

---

**Last Updated:** December 10, 2024  
**Total Variables:** 35  
**Status:** ‚úÖ Fully Configured
