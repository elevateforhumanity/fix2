import{r as a}from"./vendor-react-mXmGo1rS.js";import{s as t}from"./supa-BrS98-L_.js";function r(){const[r,s]=a.useState(null),[e,i]=a.useState(!0);return a.useEffect(()=>{(async()=>{const{data:{user:a}}=await t.auth.getUser();if(a){const{data:r}=await t.from("profiles").select("id, email, full_name, role").eq("id",a.id).single();s(r)}else s(null);i(!1)})();const{data:a}=t.auth.onAuthStateChange(async(a,r)=>{if(null==r?void 0:r.user){const{data:a}=await t.from("profiles").select("id, email, full_name, role").eq("id",r.user.id).single();s(a)}else s(null)});return()=>{a.subscription.unsubscribe()}},[]),{user:r,loading:e}}async function s(a,r){const{data:s,error:e}=await t.auth.signUp({email:a,password:r});if(e)throw e;return s}async function e(a,r){const{data:s,error:e}=await t.auth.signInWithPassword({email:a,password:r});if(e)throw e;return s}async function i(a){const{data:r,error:s}=await t.auth.signInWithOtp({email:a,options:{emailRedirectTo:`${window.location.origin}/lms`}});if(s)throw s;return r}async function n(){const{error:a}=await t.auth.signOut();if(a)throw a}async function o(a){const{data:r,error:s}=await t.auth.resetPasswordForEmail(a,{redirectTo:`${window.location.origin}/auth/reset-password`});if(s)throw s;return r}async function u(){const{data:{user:a}}=await t.auth.getUser();if(!a)return null;const{data:r}=await t.from("profiles").select("role").eq("id",a.id).single();return{id:a.id,email:a.email,role:(null==r?void 0:r.role)||"student"}}export{e as a,i as b,s as c,u as g,o as r,n as s,r as u};
