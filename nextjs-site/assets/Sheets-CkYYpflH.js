import{r as e,j as r}from"./vendor-react-mXmGo1rS.js";import"./vendor-BU8AdXDg.js";function o(){var o;const[l,t]=e.useState(null),[n,d]=e.useState(null),[i,a]=e.useState({row:0,col:0}),[s,u]=e.useState(""),[c,f]=e.useState(!1);e.useEffect(()=>{p()},[]);const p=async()=>{const e={id:"sheet_1",title:"Untitled Spreadsheet",sheets:["sheet1"],sheetsData:[{id:"sheet1",name:"Sheet1",rows:100,cols:26,cells:{}}]};t(e),d(e.sheetsData[0])},b=e=>{u(e.target.value)},x=async()=>{if(!n)return;const e=`${i.row},${i.col}`,r=s.startsWith("="),o={row:i.row,col:i.col,value:s,formula:r?s:null,displayValue:s};n.cells[e]=o,f(!1),console.log("Cell updated:",o)},h=e=>{let r="",o=e+1;for(;o>0;){const e=(o-1)%26;r=String.fromCharCode(65+e)+r,o=Math.floor((o-1)/26)}return r},m=(e,r)=>{const o=`${e},${r}`,l=null==n?void 0:n.cells[o];return(null==l?void 0:l.displayValue)||""},v=(e,r)=>i.row===e&&i.col===r;return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"var(--brand-surface)"},children:[r.jsxs("div",{style:{backgroundColor:"#fff",borderBottom:"1px solid var(--brand-border)",padding:"0.75rem 1rem",display:"flex",gap:"1rem",alignItems:"center"},children:[r.jsx("input",{type:"text","aria-label":"text input",value:(null==l?void 0:l.title)||"Untitled Spreadsheet",style:{border:"none",fontSize:"1.125rem",fontWeight:"500",outline:"none",width:"300px"}}),r.jsx("div",{style:{flex:1}}),r.jsx("button",{style:{padding:"0.5rem 1rem",backgroundColor:"#fff",border:"1px solid var(--brand-border-dark)",borderRadius:"0.375rem",cursor:"pointer"},children:"ðŸ’¾ Save"}),r.jsx("button",{style:{padding:"0.5rem 1rem",backgroundColor:"var(--brand-info)",color:"#fff",border:"none",borderRadius:"0.375rem",cursor:"pointer"},children:"Share"})]}),r.jsxs("div",{style:{backgroundColor:"#fff",borderBottom:"1px solid var(--brand-border)",padding:"0.5rem 1rem",display:"flex",gap:"1rem",alignItems:"center"},children:[r.jsxs("div",{style:{padding:"0.5rem",backgroundColor:"#f3f4f6",borderRadius:"0.25rem",minWidth:"60px",textAlign:"center",fontWeight:"600"},children:[h(i.col),i.row+1]}),r.jsx("input",{type:"text","aria-label":"text input",value:s,onChange:b,onKeyPress:e=>{"Enter"===e.key&&x()},placeholder:"Enter value or formula (=SUM(A1:A10))",style:{flex:1,padding:"0.5rem",border:"1px solid var(--brand-border-dark)",borderRadius:"0.375rem",fontSize:"0.875rem"}})]}),r.jsx("div",{style:{flex:1,overflow:"auto",backgroundColor:"#fff"},children:r.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",tableLayout:"fixed"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:"40px",backgroundColor:"#f3f4f6",border:"1px solid var(--brand-border)",position:"sticky",top:0,left:0,zIndex:3}}),Array.from({length:(null==n?void 0:n.cols)||26},(e,o)=>r.jsx("th",{style:{width:"100px",backgroundColor:"#f3f4f6",border:"1px solid var(--brand-border)",padding:"0.5rem",fontSize:"0.875rem",fontWeight:"600",position:"sticky",top:0,zIndex:2},children:h(o)},o))]})}),r.jsx("tbody",{children:Array.from({length:(null==n?void 0:n.rows)||100},(e,o)=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:"40px",backgroundColor:"#f3f4f6",border:"1px solid var(--brand-border)",padding:"0.5rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",position:"sticky",left:0,zIndex:1},children:o+1}),Array.from({length:(null==n?void 0:n.cols)||26},(e,l)=>r.jsx("td",{onClick:()=>((e,r)=>{a({row:e,col:r});const o=`${e},${r}`,l=null==n?void 0:n.cells[o];u((null==l?void 0:l.formula)||(null==l?void 0:l.value)||""),f(!1)})(o,l),onDoubleClick:()=>((e,r)=>{a({row:e,col:r});const o=`${e},${r}`,l=null==n?void 0:n.cells[o];u((null==l?void 0:l.formula)||(null==l?void 0:l.value)||""),f(!0)})(o,l),style:{border:"1px solid var(--brand-border)",padding:"0.5rem",cursor:"cell",backgroundColor:v(o,l)?"#dbeafe":"#fff",outline:v(o,l)?"2px solid var(--brand-info)":"none",position:"relative"},children:c&&v(o,l)?r.jsx("input",{type:"text","aria-label":"text input",value:s,onChange:b,onBlur:x,onKeyPress:e=>{"Enter"===e.key&&x()},autoFocus:!0,style:{width:"100%",border:"none",outline:"none",padding:0,backgroundColor:"transparent"}}):m(o,l)},l))]},o))})]})}),r.jsxs("div",{style:{backgroundColor:"#fff",borderTop:"1px solid var(--brand-border)",padding:"0.5rem 1rem",display:"flex",gap:"0.5rem"},children:[null==(o=null==l?void 0:l.sheetsData)?void 0:o.map(e=>r.jsx("button",{onClick:()=>d(e),style:{padding:"0.5rem 1rem",backgroundColor:(null==n?void 0:n.id)===e.id?"#e0e7ff":"transparent",border:"none",borderRadius:"0.375rem",cursor:"pointer",fontWeight:(null==n?void 0:n.id)===e.id?"600":"400"},children:e.name},e.id)),r.jsx("button",{style:{padding:"0.5rem 1rem",backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"1.25rem"},children:"+"})]})]})}export{o as Sheets,o as default};
