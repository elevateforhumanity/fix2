import{r as e,j as s}from"./vendor-react-mXmGo1rS.js";import{u as t,L as l}from"./vendor-router-umqT_8ks.js";import{s as a}from"./supa-BrS98-L_.js";import"./vendor-BU8AdXDg.js";import"./vendor-supabase-BOQaJsF3.js";function n(){const{courseId:n}=t(),[r,i]=e.useState(null),[d,o]=e.useState([]),[c,m]=e.useState(!1),[x,u]=e.useState({title:"",video_url:"",html:""});async function h(){const{data:e}=await a.from("courses").select("*").eq("id",n).single();i(e);const{data:s}=await a.from("lessons").select("*").eq("course_id",n).order("idx");o(s||[])}return e.useEffect(()=>{h()},[n]),r?s.jsx("section",{className:"section",children:s.jsxs("div",{className:"container max-w-4xl",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(l,{to:"/instructor",className:"text-sm text-brand-600 hover:text-brand-700",children:"â† Back to Dashboard"}),s.jsx("h1",{className:"mt-2 text-3xl font-bold",children:r.title}),s.jsx("p",{className:"mt-1 text-brand-text-muted",children:"Manage lessons"})]}),s.jsx("button",{onClick:()=>m(!c),className:"btn",children:c?"Cancel":"+ Add Lesson"})]}),c&&s.jsxs("form",{onSubmit:async function(e){e.preventDefault();const s=d.length+1,{error:t}=await a.from("lessons").insert([{course_id:n,idx:s,...x}]);t?alert(t.message):(u({title:"",video_url:"",html:""}),m(!1),h())},className:"mt-6 card p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lesson Title *"}),s.jsx("input",{type:"text","aria-label":"text input",value:x.title,onChange:e=>u({...x,title:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Video URL (YouTube embed)"}),s.jsx("input",{type:"url","aria-label":"url input",value:x.video_url,onChange:e=>u({...x,video_url:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"https://www.youtube.com/embed/..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Content (HTML)"}),s.jsx("textarea",{value:x.html,onChange:e=>u({...x,html:e.target.value}),className:"w-full px-3 py-2 border rounded-lg font-mono text-sm",rows:6,placeholder:"<p>Lesson content here...</p>"})]}),s.jsx("button",{type:"submit",className:"btn",children:"Add Lesson"})]}),s.jsxs("div",{className:"mt-8 space-y-3",children:[d.map(e=>s.jsxs("div",{className:"card p-5 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"text-xs text-brand-text-light",children:["Lesson ",e.idx]}),s.jsx("div",{className:"font-semibold",children:e.title}),e.video_url&&s.jsx("div",{className:"mt-1 text-xs text-brand-text-light",children:"ðŸ“¹ Video"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(l,{to:`/lms/lesson/${e.id}`,className:"btn-outline",target:"_blank",children:"Preview"}),s.jsx("button",{onClick:()=>async function(e){if(!confirm("Delete this lesson?"))return;const{error:s}=await a.from("lessons").delete().eq("id",e);s?alert(s.message):h()}(e.id),className:"btn-outline text-red-600 border-red-300 hover:bg-red-50",children:"Delete"})]})]},e.id)),0===d.length&&s.jsx("div",{className:"card p-6 text-center text-brand-text-muted",children:"No lessons yet. Add your first lesson to get started!"})]})]})}):s.jsx("div",{className:"section",children:s.jsx("div",{className:"container",children:"Loading..."})})}export{n as default};
