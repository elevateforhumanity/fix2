import{r as e,j as r}from"./vendor-react-mXmGo1rS.js";import{u as t,b as n}from"./vendor-router-umqT_8ks.js";import"./vendor-BU8AdXDg.js";var o={};function i({meetingCode:t,userName:n,isModerator:i=!1,onLeave:a}){const s=e.useRef(null),[d,l]=e.useState(null),[c,m]=e.useState(!1),[u,g]=e.useState([]),[p,f]=e.useState(!0);e.useEffect(()=>{const e=()=>{const e=o.REACT_APP_JITSI_DOMAIN||"meet.jit.si",i={roomName:t,width:"100%",height:"100%",parentNode:s.current,userInfo:{displayName:n,email:""},configOverwrite:{startWithAudioMuted:!1,startWithVideoMuted:!1,enableWelcomePage:!1,prejoinPageEnabled:!1,disableDeepLinking:!0,enableClosePage:!1,toolbarButtons:["microphone","camera","closedcaptions","desktop","fullscreen","fodeviceselection","hangup","profile","chat","recording","livestreaming","etherpad","sharedvideo","settings","raisehand","videoquality","filmstrip","feedback","stats","shortcuts","tileview","videobackgroundblur","download","help","mute-everyone","security"]},interfaceConfigOverwrite:{SHOW_JITSI_WATERMARK:!1,SHOW_WATERMARK_FOR_GUESTS:!1,SHOW_BRAND_WATERMARK:!1,BRAND_WATERMARK_LINK:"",SHOW_POWERED_BY:!1,DISPLAY_WELCOME_PAGE_CONTENT:!1,DISPLAY_WELCOME_PAGE_TOOLBAR_ADDITIONAL_CONTENT:!1,APP_NAME:"Elevate Meet",NATIVE_APP_NAME:"Elevate Meet",PROVIDER_NAME:"Elevate for Humanity",MOBILE_APP_PROMO:!1}},d=new window.JitsiMeetExternalAPI(e,i);d.addEventListener("videoConferenceJoined",e=>{console.log("Joined meeting:",e),f(!1)}),d.addEventListener("participantJoined",e=>{console.log("Participant joined:",e),r(d)}),d.addEventListener("participantLeft",e=>{console.log("Participant left:",e),r(d)}),d.addEventListener("videoConferenceLeft",()=>{console.log("Left meeting"),a&&a()}),d.addEventListener("recordingStatusChanged",e=>{m(e.on)}),l(d)},r=async e=>{const r=await e.getParticipantsInfo();g(r)};return(()=>{if(window.JitsiMeetExternalAPI)return void e();const r=document.createElement("script");r.src="https://meet.jit.si/external_api.js",r.async=!0,r.onload=()=>e(),document.body.appendChild(r)})(),()=>{d&&d.dispose()}},[t,n,a]);return r.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#000"},children:[p&&r.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#fff",fontSize:"1.5rem",zIndex:1e3},children:"Joining meeting..."}),r.jsxs("div",{style:{padding:"1rem",backgroundColor:"#1a1a1a",color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h3",{style:{margin:0},children:"Elevate Meet"}),r.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.875rem",opacity:.7},children:["Meeting Code: ",t]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[c&&r.jsxs("span",{style:{padding:"0.25rem 0.75rem",backgroundColor:"var(--brand-danger)",borderRadius:"0.25rem",fontSize:"0.875rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("span",{style:{width:"8px",height:"8px",backgroundColor:"#fff",borderRadius:"50%",animation:"pulse 2s infinite"}}),"Recording"]}),r.jsxs("span",{style:{fontSize:"0.875rem"},children:[u.length," participant",1!==u.length?"s":""]})]})]}),r.jsx("div",{ref:s,style:{flex:1,width:"100%",height:"100%"}}),i&&r.jsx("div",{style:{position:"absolute",bottom:"2rem",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"1rem",padding:"1rem",backgroundColor:"rgba(0, 0, 0, 0.8)",borderRadius:"0.5rem",zIndex:100},children:c?r.jsx("button",{onClick:()=>{d&&i&&d.executeCommand("stopRecording","file")},style:{padding:"0.5rem 1rem",backgroundColor:"var(--brand-text-muted)",color:"#fff",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Stop Recording"}):r.jsx("button",{onClick:()=>{d&&i&&d.executeCommand("startRecording",{mode:"file"})},style:{padding:"0.5rem 1rem",backgroundColor:"var(--brand-danger)",color:"#fff",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Start Recording"})}),r.jsx("style",{children:"\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n      "})]})}function a(){const{meetingCode:o}=t(),a=n(),[s,d]=e.useState(""),[l,c]=e.useState(!1),[m,u]=e.useState(null),[g,p]=e.useState(!0);e.useEffect(()=>{o?(async()=>{try{const e=await fetch(`/api/meetings/${o}`),r=await e.json();u(r)}catch(e){console.error("Failed to load meeting:",e)}finally{p(!1)}})():p(!1);const e=localStorage.getItem("userName");e&&d(e)},[o]);const f=()=>{s.trim()?(localStorage.setItem("userName",s),c(!0),fetch(`/api/meetings/${o}/join`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:s})}).catch(console.error)):alert("Please enter your name")};return g?r.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#f3f4f6"},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid var(--brand-border)",borderTopColor:"var(--brand-info)",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 1rem"}}),r.jsx("p",{style:{color:"var(--brand-text-muted)"},children:"Loading meeting..."})]}),r.jsx("style",{children:"\n          @keyframes spin {\n            to { transform: rotate(360deg); }\n          }\n        "})]}):o?l?r.jsx(i,{meetingCode:o,userName:s,isModerator:"current-user-id"===(null==m?void 0:m.hostId),onLeave:()=>{fetch(`/api/meetings/${o}/leave`,{method:"POST"}).catch(console.error),a("/dashboard")}}):r.jsxs("div",{style:{maxWidth:"600px",margin:"4rem auto",padding:"2rem",backgroundColor:"#fff",borderRadius:"0.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[r.jsx("h1",{style:{marginBottom:"0.5rem"},children:(null==m?void 0:m.title)||"Join Meeting"}),r.jsxs("p",{style:{color:"var(--brand-text-muted)",marginBottom:"2rem"},children:["Meeting code: ",r.jsx("strong",{children:o})]}),m&&r.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f3f4f6",borderRadius:"0.375rem",marginBottom:"2rem"},children:[r.jsxs("p",{style:{margin:"0.25rem 0",fontSize:"0.875rem"},children:[r.jsx("strong",{children:"Host:"})," ",m.hostName||"Unknown"]}),r.jsxs("p",{style:{margin:"0.25rem 0",fontSize:"0.875rem"},children:[r.jsx("strong",{children:"Scheduled:"})," ",new Date(m.scheduledAt).toLocaleString()]}),r.jsxs("p",{style:{margin:"0.25rem 0",fontSize:"0.875rem"},children:[r.jsx("strong",{children:"Duration:"})," ",m.duration," minutes"]})]}),r.jsxs("div",{style:{marginBottom:"1rem"},children:[r.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"var(--brand-text)"},children:"Your Name"}),r.jsx("input",{type:"text","aria-label":"text input",value:s,onChange:e=>d(e.target.value),placeholder:"Enter your name",style:{width:"100%",padding:"0.75rem",border:"1px solid var(--brand-border-dark)",borderRadius:"0.375rem",fontSize:"1rem"},onKeyPress:e=>{"Enter"===e.key&&f()}})]}),r.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox","aria-label":"checkbox input",defaultChecked:!0}),r.jsx("span",{style:{fontSize:"0.875rem"},children:"Camera on"})]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox","aria-label":"checkbox input",defaultChecked:!0}),r.jsx("span",{style:{fontSize:"0.875rem"},children:"Microphone on"})]})]}),r.jsx("button",{onClick:f,style:{width:"100%",padding:"0.75rem",backgroundColor:"var(--brand-info)",color:"#fff",border:"none",borderRadius:"0.375rem",fontSize:"1rem",cursor:"pointer",fontWeight:"500"},children:"Join Meeting"}),r.jsx("button",{onClick:()=>a("/dashboard"),style:{width:"100%",padding:"0.75rem",backgroundColor:"transparent",color:"var(--brand-text-muted)",border:"none",borderRadius:"0.375rem",fontSize:"0.875rem",cursor:"pointer",marginTop:"0.5rem"},children:"Cancel"})]}):r.jsxs("div",{style:{maxWidth:"600px",margin:"4rem auto",padding:"2rem",backgroundColor:"#fff",borderRadius:"0.5rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[r.jsx("h1",{style:{marginBottom:"1rem"},children:"Join a Meeting"}),r.jsx("p",{style:{color:"var(--brand-text-muted)",marginBottom:"2rem"},children:"Enter a meeting code to join"}),r.jsx("input",{type:"text","aria-label":"text input",placeholder:"Meeting code",style:{width:"100%",padding:"0.75rem",border:"1px solid var(--brand-border-dark)",borderRadius:"0.375rem",fontSize:"1rem",marginBottom:"1rem"},onKeyPress:e=>{"Enter"===e.key&&e.target.value&&a(`/meet/${e.target.value}`)}}),r.jsx("button",{onClick:()=>{const e=document.querySelector("input").value;e&&a(`/meet/${e}`)},style:{width:"100%",padding:"0.75rem",backgroundColor:"var(--brand-info)",color:"#fff",border:"none",borderRadius:"0.375rem",fontSize:"1rem",cursor:"pointer",fontWeight:"500"},children:"Join Meeting"})]})}export{a as VideoMeeting,a as default};
