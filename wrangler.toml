# Cloudflare Workers Configuration for Autopilot Deploy Worker

name = "autopilot-deploy-worker"
main = "workers/autopilot-deploy-worker.ts"
compatibility_date = "2024-01-01"

# Routes - integrate with Netlify site
routes = [
  { pattern = "elevateforhumanity.org/api/worker/*", zone_name = "elevateforhumanity.org" },
  { pattern = "elevateforhumanityfix2.netlify.app/api/worker/*", zone_name = "elevateforhumanityfix2.netlify.app" }
]

# Account details (set via wrangler login or env vars)
# account_id = "your-cloudflare-account-id"

# Workers KV for state storage (optional)
# kv_namespaces = [
#   { binding = "AUTOPILOT_STATE", id = "your-kv-namespace-id" }
# ]

# Secrets (set via: wrangler secret put SECRET_NAME)
# - AUTOPILOT_TOKEN
# - NETLIFY_TOKEN
# - NETLIFY_SITE_ID
# - GITHUB_TOKEN
# - SUPABASE_URL

# Cron triggers for scheduled health checks
[triggers]
crons = ["*/10 * * * *"]  # Every 10 minutes

# Environment variables (non-sensitive)
[vars]
ENVIRONMENT = "production"

# Development settings
[env.development]
name = "autopilot-deploy-worker-dev"
vars = { ENVIRONMENT = "development" }

# Production settings
[env.production]
name = "autopilot-deploy-worker"
vars = { ENVIRONMENT = "production" }

# Build configuration
[build]
command = "npm install && npm run build"

[build.upload]
format = "service-worker"
