# Elevate for Humanity - Gitpod Configuration
# Professional LMS development environment

image:
  file: .gitpod.Dockerfile

ports:
  - port: 5173
    onOpen: open-preview
    visibility: public
    name: Vite Dev Server
    description: EFH LMS Development Server
  - port: 8080
    onOpen: open-preview
    visibility: public
    name: Vite Preview Server
    description: Production Build Preview
  - port: 4173
    onOpen: ignore
    visibility: public
    name: Vite Preview (Alt)
    description: Alternative Preview Port
  - port: 7070
    onOpen: ignore
    visibility: public
    name: Backend API
    description: Python FastAPI Backend
  - port: 3000
    onOpen: ignore
    visibility: private

tasks:
  - name: Setup Elevate Script Pack & Seeds
    init: |
      echo "ğŸ“ Welcome to Elevate for Humanity LMS Development"
      echo ""
      mkdir -p scripts docs seeds
      echo ""
      echo "ğŸ”§ Setting up environment..."
      chmod +x scripts/auto-setup-env.sh || true
      ./scripts/auto-setup-env.sh || echo "âš ï¸  Environment setup needed - run: bash scripts/setup-env.sh"
      echo ""
      echo "ğŸ“š Generating Elevate Script Pack..."
      chmod +x scripts/bootstrap-elevate-scripts.sh || true
      ./scripts/bootstrap-elevate-scripts.sh || echo "Run scripts/bootstrap-elevate-scripts.sh manually if needed."
      echo ""
      echo "ğŸŒ± Generating Content Seeds..."
      chmod +x scripts/generate-elevate-seeds.sh || true
      ./scripts/generate-elevate-seeds.sh || echo "Run scripts/generate-elevate-seeds.sh manually if needed."
      echo ""
      echo "ğŸ“˜ Generating Digital Package..."
      chmod +x scripts/generate-elevate-digital.sh || true
      ./scripts/generate-elevate-digital.sh || echo "Run scripts/generate-elevate-digital.sh manually if needed."
      echo ""
      bash scripts/setup.sh || echo "Setup script not found, continuing..."
      echo ""
      echo "ğŸ¨ Generating course covers..."
      node scripts/generate-course-covers.mjs || echo "Course cover generation skipped"
    command: |
      echo ""
      echo "âœ… Workspace ready!"
      echo ""
      echo "ğŸ“š Script Pack: docs/Elevate_Script_Pack.md"
      echo "ğŸ”— Quick Start: QUICK_START.md"
      echo "ğŸ“ Phone: (317) 314-3757"
      echo ""
      echo "ğŸ“š Quick Start:"
      echo "   npm run dev       - Start dev server"
      echo "   npm run build     - Build for production"
      echo "   npm run typecheck - Check TypeScript"
      echo "   npm run lint      - Run ESLint"
      echo ""
      echo "ğŸ”§ Utility Scripts:"
      echo "   bash scripts/verify-env.sh      - Check environment variables"
      echo "   bash scripts/test.sh            - Run all checks"
      echo "   bash scripts/netlify-preview.sh - Deploy preview"
      echo "   npm run generate-covers         - Regenerate course covers"
      echo ""
      echo "ğŸš€ Starting dev server..."
      npm run dev || bash scripts/dev.sh || echo "Start server with: npm run dev"
  
  - name: Elevate Fix
    init: |
      chmod +x gp-fix.sh || true
      ./gp-fix.sh || true
    command: |
      echo "Gitpod is ready. If the build above failed, scroll up to see why."
      echo "To re-run the helper script manually, use:"
      echo "  ./gp-fix.sh"
      gp sync-done vercel-check
  
  - name: Backend (Optional)
    command: |
      gp sync-await vercel-check
      if [ -d backend ] && [ -f backend/requirements.txt ]; then
        echo "ğŸ Starting Python backend..."
        cd backend
        python3 -m venv .venv
        source .venv/bin/activate
        pip install -r requirements.txt
        uvicorn main:app --reload --host 0.0.0.0 --port 7070
      else
        echo "â„¹ï¸  No backend directory found - frontend only mode"
        echo "   Backend API not required for basic LMS functionality"
      fi

vscode:
  extensions:
    # Essential
    - esbenp.prettier-vscode
    - dbaeumer.vscode-eslint
    - bradlc.vscode-tailwindcss
    
    # TypeScript & React
    - ms-vscode.vscode-typescript-next
    - dsznajder.es7-react-js-snippets
    
    # Utilities
    - christian-kohler.path-intellisense
    - formulahendry.auto-rename-tag
    - naumovs.color-highlight
    
    # Git
    - eamodio.gitlens
    
    # Optional but helpful
    - usernamehw.errorlens
    - streetsidesoftware.code-spell-checker

github:
  prebuilds:
    master: true
    branches: true
    pullRequests: true
    pullRequestsFromForks: false
    addCheck: true
    addComment: false
    addBadge: false
